<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Database indexing | @kyungyunlee&#39;s notes</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/TIL/logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <meta name="description" content="My Personal Wiki (Today I Learned)">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.98cb0daf.css" as="style"><link rel="preload" href="/TIL/assets/js/app.47e7122b.js" as="script"><link rel="preload" href="/TIL/assets/js/2.3a8afc01.js" as="script"><link rel="preload" href="/TIL/assets/js/12.26505886.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.d58d22f2.js"><link rel="prefetch" href="/TIL/assets/js/11.c83ffcd6.js"><link rel="prefetch" href="/TIL/assets/js/13.3cd93f2e.js"><link rel="prefetch" href="/TIL/assets/js/14.5c48d207.js"><link rel="prefetch" href="/TIL/assets/js/15.44de18dd.js"><link rel="prefetch" href="/TIL/assets/js/16.a0f29604.js"><link rel="prefetch" href="/TIL/assets/js/17.d265fe11.js"><link rel="prefetch" href="/TIL/assets/js/18.6333c551.js"><link rel="prefetch" href="/TIL/assets/js/19.0c5688a1.js"><link rel="prefetch" href="/TIL/assets/js/20.edd87bbc.js"><link rel="prefetch" href="/TIL/assets/js/21.b34f006e.js"><link rel="prefetch" href="/TIL/assets/js/22.0d3e5c39.js"><link rel="prefetch" href="/TIL/assets/js/23.d4b048d9.js"><link rel="prefetch" href="/TIL/assets/js/24.e480ed38.js"><link rel="prefetch" href="/TIL/assets/js/3.d96adee9.js"><link rel="prefetch" href="/TIL/assets/js/4.ad4aa63e.js"><link rel="prefetch" href="/TIL/assets/js/5.2c70dfa1.js"><link rel="prefetch" href="/TIL/assets/js/6.40ee570f.js"><link rel="prefetch" href="/TIL/assets/js/7.5937946b.js"><link rel="prefetch" href="/TIL/assets/js/8.7233080d.js"><link rel="prefetch" href="/TIL/assets/js/9.2950460c.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.98cb0daf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">@kyungyunlee's notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/kyungyunlee/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://kyungyunlee.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/kyungyunlee/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://kyungyunlee.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Monthly I Learned</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Database</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/Database/1_relational_model.html" class="sidebar-link">Relational model and SQL</a></li><li><a href="/TIL/Database/2_database_storage.html" class="sidebar-link">Database storage</a></li><li><a href="/TIL/Database/3_acid.html" class="sidebar-link">ACID properties</a></li><li><a href="/TIL/Database/4_database_indexing.html" aria-current="page" class="active sidebar-link">Database indexing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Database/4_database_indexing.html#heap" class="sidebar-link">Heap</a></li><li class="sidebar-sub-header"><a href="/TIL/Database/4_database_indexing.html#clustered-index" class="sidebar-link">Clustered index</a></li><li class="sidebar-sub-header"><a href="/TIL/Database/4_database_indexing.html#query-plans-and-optimization" class="sidebar-link">Query plans and optimization</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Functional Programming</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/TIL/Books/" class="sidebar-link">Books</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ETC</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="database-indexing"><a href="#database-indexing" class="header-anchor">#</a> Database indexing</h1> <p>2021.08.30</p> <h2 id="heap"><a href="#heap" class="header-anchor">#</a> Heap</h2> <p>In database, heap is an unordered table. It is just pages stored in disk.</p> <p>If you insert a row into a heap, you are not guaranteed with any order of the rows (pages).</p> <p>So, obviously searching for a specific row will not be efficient.</p> <p>Therefore, comes indexes!</p> <h2 id="clustered-index"><a href="#clustered-index" class="header-anchor">#</a> Clustered index</h2> <p>Index is a separate structure from table, which only contains information about the ordering of the table.</p> <p>The purpose of index is to optimize the queries and therefore, search efficiently.</p> <p>Normally, the index is implemented as B-trees or LSM trees and primary key is the default column for indexes in many databases. (You can make other indexes with other columns).</p> <p>Clustered index is also very good for range queries, since nearby/similar keys will be clustered, reducing heap acess and increasing cache hit rate.</p> <h2 id="query-plans-and-optimization"><a href="#query-plans-and-optimization" class="header-anchor">#</a> Query plans and optimization</h2> <ul><li>&quot;explain&quot; and &quot;analyze&quot; commands in database shows the query plan and the query execution time.</li></ul> <p>If using index, performing select queries with a &quot;where&quot; condition on indexed columns, the database will first access the index table and then access the heap for actual data when needed. Therefore, not requiring the full scan of the table.</p> <p>When you have an index using the &quot;id&quot; column,  the below query will only need to access the index table, not the heap, because the query only asked for &quot;id&quot; which is in the index table =&gt; query plan = &quot;Index only scan&quot;</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> table1 <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><p>But, if you ask for more columns, the database will have to access the heap, since &quot;name&quot; column is not in the index table, only in the heap =&gt; query plan = &quot;Index scan&quot;</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> id<span class="token punctuation">,</span> name <span class="token keyword">from</span> table1 <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><p>For freqeuently accessed columns, it seems like a good idea to make another index for that column.</p> <p>In case of using a where condition on non-indexed columns, the database has to do a full scan unfortunately =&gt; query plan &quot;Seq scan&quot;</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> id<span class="token punctuation">,</span> grade <span class="token keyword">from</span> table1 <span class="token keyword">where</span> grade<span class="token operator">=</span><span class="token number">55</span><span class="token punctuation">;</span>
</code></pre></div><p>Normally bad queries</p> <ul><li>SELECT * queries :  always require heap access</li> <li>LIKE clause : needs to do full scan despite the presence of index table</li></ul> <p>To do : B-tree vs LSM-tree</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/Database/3_acid.html" class="prev">
        ACID properties
      </a></span> <span class="next"><a href="/TIL/functional-programming/scala-basics.html">
        Scala basics
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.47e7122b.js" defer></script><script src="/TIL/assets/js/2.3a8afc01.js" defer></script><script src="/TIL/assets/js/12.26505886.js" defer></script>
  </body>
</html>
